(()=>{"use strict";function e(e,t){var o=t.deleteCard,r=t.cardTemplate,c=t.openPopupImageModal,a=r.querySelector(".card").cloneNode(!0),s=a.querySelector(".card__image"),u=a.querySelector(".card__title"),i=a.querySelector(".card__delete-button"),l=a.querySelector(".card__like-button");return s.src=e.link,s.alt="Изображение "+e.name,u.textContent=e.name,s.addEventListener("click",(function(){return c(e.link,e.name)})),i.addEventListener("click",(function(){return o(a)})),l.addEventListener("click",n),a}function t(e){e.remove()}function n(e){e.target.classList.toggle("card__like-button_is-active")}var o=function(e){"Escape"===e.key&&r(document.querySelector(".popup_is-opened"))};function r(e){e.classList.remove("popup_is-opened"),document.removeEventListener("keydown",o)}function c(e){e.classList.add("popup_is-opened"),document.addEventListener("keydown",o)}function a(e,t){e.classList.remove(t)}function s(e,t){e.classList.add(t),e.disabled=!0}var u=function(e){return e.some((function(e){return!e.validity.valid}))};function i(e,t){var n=e.querySelectorAll(t.inputSelector);e.reset(),n.forEach((function(n){n.classList.remove(t.inputErrorClass),a(e.querySelector(".".concat(n.id,"__input-error")),t.errorClass)}))}var l,p="https://mesto.nomoreparties.co/v1/".concat("wff-cohort-33"),d={headers:{authorization:"".concat("55d1b029-4425-46a4-9f07-dcff1368dd95")}},m=document.querySelector("#card-template").content,f=document.querySelectorAll(".popup"),v=document.querySelector(".places__list"),_=document.querySelector(".popup_type_edit"),y=document.querySelector(".popup_type_new-card"),S=document.querySelector(".popup_type_image"),k=document.querySelector(".profile__edit-button"),g=document.querySelector(".profile__add-button"),q=document.querySelector(".profile__title"),C=document.querySelector(".profile__image"),h=document.querySelector(".profile__description"),L=document.forms["edit-profile"],E=L.name,b=L.description,x=document.forms["new-place"],j=x["place-name"],w=x.link,A={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"};function B(e,t){var n=S.querySelector(".popup__image");S.querySelector(".popup__caption").textContent=t,n.src=e,n.alt="Изображение "+t,c(S)}fetch("".concat(p,"/users/me"),d).then((function(e){return e.ok?e.json():Promise.reject("Упссс... Пользователь не найден: ".concat(e.status))})).catch((function(e){console.log(e)})).then((function(e){q.textContent=e.name,h.textContent=e.about,C.style.backgroundImage="url(".concat(e.avatar,")")})),f.forEach((function(e){var t;(t=e).querySelector(".popup__close").addEventListener("click",(function(){return r(t)})),t.addEventListener("mousedown",(function(e){e.target.classList.contains("popup")&&r(t)}))})),k.addEventListener("click",(function(){i(L,A),b.value=h.textContent,E.value=q.textContent,c(_)})),g.addEventListener("click",(function(){i(x,A),c(y)})),L.addEventListener("submit",(function(e){e.preventDefault(),q.textContent=E.value,h.textContent=b.value,r(e.target.closest(".popup"))})),x.addEventListener("submit",(function(n){n.preventDefault();var o={name:j.value,link:w.value};v.prepend(e(o,{deleteCard:t,cardTemplate:m,openPopupImageModal:B})),x.reset(),r(n.target.closest(".popup"))})),[{name:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{name:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{name:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{name:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}].forEach((function(n){v.append(e(n,{deleteCard:t,cardTemplate:m,openPopupImageModal:B}))})),l=A,document.querySelectorAll(l.formSelector).forEach((function(e){var t=e.querySelector(l.submitButtonSelector),n=e.querySelectorAll(l.inputSelector);s(t,l.inactiveButtonClass),n.forEach((function(o){var r=e.querySelector(".".concat(o.id,"__input-error"));o.addEventListener("input",(function(e){e.target.validity.valid?(e.target.classList.remove(l.inputErrorClass),a(r,l.errorClass),u(Array.from(n))||function(e,t){e.classList.remove(t),e.disabled=!1}(t,l.inactiveButtonClass)):(e.target.classList.add(l.inputErrorClass),function(e,t,n){e.textContent=t,e.classList.add(n)}(r,e.target.validationMessage,l.errorClass),u(Array.from(n))&&s(t,l.inactiveButtonClass))}))}))}))})();